<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>babygirl</title>
    <style>
        :root {
            --color-primary: #E6E6FA;
            --color-secondary: #8A2BE2;
            --color-accent: #4B0082;
            --color-text: #FFFFFF;
            --color-background: #000000;
            --color-dark: #1a001a;
            --gradient-primary: linear-gradient(135deg, #8A2BE2, #E6E6FA);
            --gradient-dark: linear-gradient(135deg, #4B0082, #000000);
            --shadow-elegant: 0 8px 32px rgba(138, 43, 226, 0.3);
            --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--color-background);
            color: var(--color-text);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Title Ribbon */
        .title-ribbon {
            background: var(--gradient-primary);
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px;
            box-shadow: var(--shadow-elegant);
            position: relative;
            z-index: 100;
        }

        .main-title {
            font-size: 2.8rem;
            font-weight: 300;
            cursor: pointer;
            transition: var(--transition-smooth);
            font-family: 'Georgia', serif;
            letter-spacing: 3px;
            color: var(--color-text);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.4);
            flex-grow: 1;
            text-align: center;
        }

        .main-title:hover {
            transform: scale(1.08);
            text-shadow: 4px 4px 8px rgba(0, 0, 0, 0.6);
        }

        .score-window {
            background: rgba(75, 0, 130, 0.9);
            padding: 12px 22px;
            border-radius: 18px;
            display: flex;
            flex-direction: column;
            align-items: center;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(230, 230, 250, 0.4);
            min-width: 120px;
        }

        .score-label {
            font-size: 0.85rem;
            opacity: 0.9;
            margin-bottom: 6px;
            font-weight: 500;
        }

        .score-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--color-primary);
        }

        /* Main Container */
        .main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* Sidebar */
        .sidebar {
            width: 300px;
            background: var(--gradient-dark);
            padding: 25px 0;
            display: flex;
            flex-direction: column;
            gap: 12px;
            box-shadow: 5px 0 20px rgba(138, 43, 226, 0.25);
        }

        .tab {
            padding: 22px 35px;
            cursor: pointer;
            transition: var(--transition-smooth);
            border-bottom: 1px solid rgba(230, 230, 250, 0.15);
            position: relative;
            overflow: hidden;
        }

        .tab::before {
            content: '';
            position: absolute;
            left: -100%;
            top: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            transition: var(--transition-smooth);
            z-index: -1;
        }

        .tab:hover::before {
            left: 0;
        }

        .tab:hover {
            transform: translateX(15px) scale(1.03);
            color: var(--color-background);
            font-weight: 600;
        }

        .tab.active {
            background: var(--gradient-primary);
            color: var(--color-background);
            font-weight: 600;
            transform: translateX(15px);
        }

        .tab-text {
            position: relative;
            z-index: 1;
            font-size: 1.15rem;
        }

        /* Content Area */
        .content-area {
            flex: 1;
            padding: 35px;
            background: var(--color-dark);
            overflow-y: auto;
            position: relative;
        }

        .intro-screen {
            text-align: center;
            padding: 80px 50px;
            background: rgba(138, 43, 226, 0.12);
            border-radius: 25px;
            border: 2px solid rgba(230, 230, 250, 0.25);
        }

        .intro-screen h2 {
            font-size: 2.5rem;
            margin-bottom: 30px;
            color: var(--color-primary);
            font-weight: 300;
            letter-spacing: 1px;
        }

        .intro-screen p {
            font-size: 1.3rem;
            line-height: 1.7;
            opacity: 0.92;
            max-width: 650px;
            margin: 0 auto;
        }

        /* Task Cards and Options */
        .task-card, .mind-option, .drive-option {
            background: rgba(138, 43, 226, 0.25);
            border: 2px solid rgba(230, 230, 250, 0.35);
            border-radius: 18px;
            padding: 25px;
            margin: 18px 0;
            cursor: pointer;
            transition: var(--transition-smooth);
            position: relative;
            overflow: hidden;
        }

        .task-card::before, .mind-option::before, .drive-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            transition: var(--transition-smooth);
            z-index: -1;
        }

        .task-card:hover::before, .mind-option:hover::before, .drive-option:hover::before {
            left: 0;
        }

        .task-card:hover, .mind-option:hover, .drive-option:hover {
            transform: translateY(-8px) scale(1.03);
            color: var(--color-background);
            box-shadow: var(--shadow-elegant);
        }

        /* Drive Navigation */
        .drive-breadcrumb {
            display: flex;
            gap: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .breadcrumb-item {
            background: rgba(75, 0, 130, 0.7);
            padding: 10px 18px;
            border-radius: 25px;
            font-size: 0.95rem;
            cursor: pointer;
            transition: var(--transition-smooth);
        }

        .breadcrumb-item:hover {
            background: var(--color-secondary);
            transform: scale(1.08);
        }

        .breadcrumb-separator {
            color: var(--color-primary);
            font-weight: bold;
            font-size: 1.1rem;
        }

        /* Active Tasks */
        .active-task {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(138, 43, 226, 0.18);
            border: 2px solid rgba(230, 230, 250, 0.25);
            border-radius: 15px;
            padding: 18px 25px;
            margin: 12px 0;
            transition: var(--transition-smooth);
        }

        .active-task:hover {
            background: rgba(138, 43, 226, 0.28);
            transform: translateX(5px);
        }

        .done-button {
            background: var(--gradient-primary);
            border: none;
            color: var(--color-background);
            padding: 10px 18px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition-smooth);
            font-size: 0.9rem;
        }

        .done-button:hover {
            transform: scale(1.15);
            box-shadow: 0 6px 20px rgba(138, 43, 226, 0.5);
        }

        /* Scoring Table */
        .scoring-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(138, 43, 226, 0.12);
            border-radius: 18px;
            overflow: hidden;
            box-shadow: var(--shadow-elegant);
        }

        .scoring-table th {
            background: var(--gradient-primary);
            color: var(--color-background);
            padding: 18px;
            font-weight: 600;
            text-align: left;
            font-size: 1.1rem;
        }

        .scoring-table td {
            padding: 18px;
            border-bottom: 1px solid rgba(230, 230, 250, 0.15);
        }

        .scoring-table tr:hover {
            background: rgba(138, 43, 226, 0.25);
        }

        .score-input {
            background: rgba(230, 230, 250, 0.15);
            border: 2px solid rgba(230, 230, 250, 0.35);
            border-radius: 10px;
            padding: 10px 15px;
            color: var(--color-text);
            width: 90px;
            text-align: center;
            font-size: 1rem;
        }

        .score-input:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.4);
        }

        /* Bottom Ribbon */
        .bottom-ribbon {
            height: 85px;
            background: var(--gradient-dark);
            display: flex;
            align-items: center;
            justify-content: space-around;
            padding: 0 35px;
            box-shadow: 0 -8px 20px rgba(138, 43, 226, 0.25);
        }

        .bottom-btn {
            background: var(--gradient-primary);
            border: none;
            color: var(--color-background);
            padding: 16px 28px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1.05rem;
            font-weight: 600;
            transition: var(--transition-smooth);
            position: relative;
            overflow: hidden;
        }

        .bottom-btn:hover {
            transform: translateY(-4px) scale(1.08);
            box-shadow: var(--shadow-elegant);
        }

        .weekly-tasks-btn {
            flex: 1;
            max-width: 320px;
            margin: 0 25px;
            font-size: 1.15rem;
            padding: 20px 35px;
        }

        /* Floating Output */
        .floating-output {
            position: fixed;
            bottom: 110px;
            right: 35px;
            background: rgba(75, 0, 130, 0.95);
            color: var(--color-text);
            padding: 22px 28px;
            border-radius: 18px;
            box-shadow: var(--shadow-elegant);
            max-width: 380px;
            transform: translateX(100%);
            transition: var(--transition-smooth);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(230, 230, 250, 0.35);
            z-index: 1000;
            font-size: 1.05rem;
        }

        .floating-output.show {
            transform: translateX(0);
        }

        /* Chatbox */
        .chatbox {
            position: fixed;
            bottom: 110px;
            right: 35px;
            width: 380px;
            height: 450px;
            background: rgba(75, 0, 130, 0.95);
            border-radius: 18px;
            box-shadow: var(--shadow-elegant);
            display: none;
            flex-direction: column;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(230, 230, 250, 0.35);
            z-index: 1000;
        }

        .chatbox.show {
            display: flex;
        }

        .chat-header {
            background: var(--gradient-primary);
            color: var(--color-background);
            padding: 18px 25px;
            border-radius: 18px 18px 0 0;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.1rem;
        }

        .chat-close {
            background: none;
            border: none;
            color: var(--color-background);
            font-size: 1.4rem;
            cursor: pointer;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition-smooth);
        }

        .chat-close:hover {
            background: rgba(0, 0, 0, 0.25);
            transform: scale(1.1);
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .chat-message {
            padding: 12px 18px;
            border-radius: 18px;
            max-width: 85%;
            word-wrap: break-word;
            font-size: 1rem;
            line-height: 1.4;
        }

        .chat-message.dom {
            background: var(--gradient-primary);
            color: var(--color-background);
            align-self: flex-end;
            border-bottom-right-radius: 6px;
        }

        .chat-message.sub {
            background: rgba(230, 230, 250, 0.25);
            color: var(--color-text);
            align-self: flex-start;
            border-bottom-left-radius: 6px;
        }

        .chat-input-container {
            padding: 18px;
            display: flex;
            gap: 12px;
        }

        .chat-input {
            flex: 1;
            background: rgba(230, 230, 250, 0.15);
            border: 2px solid rgba(230, 230, 250, 0.35);
            border-radius: 25px;
            padding: 12px 18px;
            color: var(--color-text);
            outline: none;
            font-size: 1rem;
        }

        .chat-input:focus {
            border-color: var(--color-primary);
        }

        .chat-send {
            background: var(--gradient-primary);
            border: none;
            color: var(--color-background);
            padding: 12px 22px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition-smooth);
        }

        .chat-send:hover {
            transform: scale(1.08);
        }

        /* Upload Window */
        .upload-window {
            position: fixed;
            bottom: 110px;
            right: 35px;
            width: 380px;
            background: rgba(75, 0, 130, 0.95);
            border-radius: 18px;
            box-shadow: var(--shadow-elegant);
            padding: 25px;
            display: none;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(230, 230, 250, 0.35);
            z-index: 1000;
        }

        .upload-window.show {
            display: block;
        }

        .upload-header {
            color: var(--color-primary);
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
        }

        .upload-area {
            border: 3px dashed rgba(230, 230, 250, 0.5);
            border-radius: 15px;
            padding: 40px 25px;
            text-align: center;
            transition: var(--transition-smooth);
            cursor: pointer;
            margin-bottom: 20px;
        }

        .upload-area:hover {
            border-color: var(--color-primary);
            background: rgba(230, 230, 250, 0.12);
        }

        .upload-file-input {
            display: none;
        }

        .upload-submit {
            width: 100%;
            background: var(--gradient-primary);
            border: none;
            color: var(--color-background);
            padding: 15px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition-smooth);
            font-size: 1.05rem;
        }

        .upload-submit:hover {
            transform: scale(1.03);
        }

        /* Section Headers */
        .section-header {
            color: var(--color-primary);
            margin-bottom: 30px;
            font-size: 2.2rem;
            font-weight: 300;
            text-align: center;
            letter-spacing: 1px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                flex-direction: row;
                overflow-x: auto;
                padding: 15px;
            }
            
            .tab {
                min-width: 180px;
                padding: 18px 25px;
            }
            
            .chatbox, .upload-window, .floating-output {
                width: 90%;
                right: 5%;
            }

            .main-title {
                font-size: 2.2rem;
            }
        }
    </style>
</head>
<body>
    <!-- Title Ribbon -->
    <header class="title-ribbon">
        <h1 class="main-title" id="homeButton">babygirl</h1>
        <div class="score-window">
            <span class="score-label">Average Score</span>
            <span class="score-value" id="averageScore">0</span>
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="tab active" data-tab="pending">
                <span class="tab-text">Pending Tasklist</span>
            </div>
            <div class="tab" data-tab="mind">
                <span class="tab-text">What's on your mind</span>
            </div>
            <div class="tab" data-tab="drive">
                <span class="tab-text">Drive</span>
            </div>
            <div class="tab" data-tab="active">
                <span class="tab-text">Active Tasklist</span>
            </div>
            <div class="tab" data-tab="scoring">
                <span class="tab-text">Scoring</span>
            </div>
        </nav>

        <!-- Content Area -->
        <main class="content-area" id="contentArea">
            <div class="intro-screen">
                <h2>Welcome to your personal dashboard, babygirl</h2>
                <p>Here you can track your progress, complete tasks, and stay connected. Choose a tab from the left to begin your journey of growth and submission. Your devotion and obedience are what make our connection stronger every day.</p>
            </div>
        </main>
    </div>

    <!-- Bottom Ribbon -->
    <footer class="bottom-ribbon">
        <button class="bottom-btn" id="chatboxBtn">
            <span>💬 Chatbox</span>
        </button>
        <button class="bottom-btn weekly-tasks-btn" id="weeklyTasksBtn">
            <span>📅 Weekly Passive Tasks</span>
        </button>
        <button class="bottom-btn" id="uploadBtn">
            <span>📤 Upload</span>
        </button>
    </footer>

    <!-- Floating Output -->
    <div class="floating-output" id="floatingOutput"></div>

    <!-- Chatbox -->
    <div class="chatbox" id="chatbox">
        <div class="chat-header">
            <span>💬 Chat with Dom</span>
            <button class="chat-close" id="chatClose">×</button>
        </div>
        <div class="chat-messages" id="chatMessages">
            <div class="chat-message dom">Welcome, babygirl. How are you feeling today?</div>
        </div>
        <div class="chat-input-container">
            <input type="text" class="chat-input" id="chatInput" placeholder="Type your message...">
            <button class="chat-send" id="chatSend">Send</button>
        </div>
    </div>

    <!-- Upload Window -->
    <div class="upload-window" id="uploadWindow">
        <div class="upload-header">📤 Upload Task Proof</div>
        <div class="upload-area" id="uploadArea">
            <p>📷 Drop files here or click to select</p>
            <p style="font-size: 0.9rem; opacity: 0.7; margin-top: 10px;">Photos and videos accepted</p>
        </div>
        <input type="file" class="upload-file-input" id="uploadFileInput" accept="image/*,video/*" multiple>
        <button class="upload-submit" id="uploadSubmit">Upload Files</button>
    </div>

    <script>
        // ==========================================
        // EASILY EDITABLE TEXT CONTENT - START
        // ==========================================
        
        // Pending Tasks - Edit these as needed
        const PENDING_TASKS = [
            "Complete morning routine by 8 AM and send photo proof",
            "Practice yoga or stretching for 30 minutes",
            "Send a voice message describing your current mood",
            "Complete assigned reading and write summary",
            "Prepare healthy meal and document process",
            "Practice meditation for 15 minutes minimum",
            "Complete journaling exercise about daily gratitude",
            "Send progress photo in requested outfit"
        ];

        // Mind Options - Edit these as needed
        const MIND_OPTIONS = [
            "I'm feeling submissive and eager to please today",
            "I want to show more dedication to our dynamic", 
            "I'm thinking about how to improve myself for you",
            "I need your guidance and direction right now"
        ];

        // Drive System - 3x3x3 cascading options - Edit these as needed
        const DRIVE_OPTIONS = {
            level1: [
                "Passive Tasks?",
                "Mental Challenges", 
                "Creative Expression"
            ],
            level2: {
                "Passive Tasks?": [
                    "Clothing-related",
                    "Appearance & Grooming",
                    "Discipline & Training"
                ],
                "Mental Challenges": [
                    "Learning & Education",
                    "Meditation & Mindfulness",
                    "Problem Solving"
                ],
                "Creative Expression": [
                    "Art & Crafts",
                    "Writing & Journaling",
                    "Performance & Entertainment"
                ]
            },
            level3: {
                "Clothing-related": [
                    "I will skip on wearing panties for a week. You can check in on me any time I am free.",
                    "I know I look hot in my pink and nude bras. I'll wear only these for the next two days: you can check in any time I am free", 
                    "Flexibility and stretching routine with photos"
                ],
                "Appearance & Grooming": [
                    "I'll voluntarily learn how to dirty-talk with you throughout the week, right here on this webpage.",
                    "I'll send you a voice note affirming my submission to you, every night of this week, along with my good night text.",
                    "Outfit coordination and modeling session"
                ],
                "Discipline & Training": [
                    "Posture maintenance throughout the day with checks",
                    "Voice modulation and speech practice exercises",
                    "Etiquette and mannerisms training session"
                ],
                "Learning & Education": [
                    "Read assigned chapter and provide detailed summary",
                    "Study new language for 45 minutes with progress notes",
                    "Research topic of interest and create presentation"
                ],
                "Meditation & Mindfulness": [
                    "Guided meditation session with reflection journal",
                    "Breathing exercises with mindfulness recording",
                    "Visualization techniques practice with description"
                ],
                "Problem Solving": [
                    "Complete logic puzzle and explain solution process",
                    "Strategic planning task with detailed outcome",
                    "Creative problem analysis with multiple solutions"
                ],
                "Art & Crafts": [
                    "Sketch daily subject with artistic interpretation",
                    "Digital art creation following specific theme",
                    "Handmade craft project with step-by-step documentation"
                ],
                "Writing & Journaling": [
                    "Reflective journal entry about personal growth",
                    "Creative story writing with character development",
                    "Letter of appreciation and gratitude expression"
                ],
                "Performance & Entertainment": [
                    "Dance routine practice with video recording",
                    "Vocal exercises and singing performance",
                    "Acting scene study with emotional expression"
                ]
            }
        };

        // Weekly Tasks - Edit these as needed
        const WEEKLY_TASKS = [
            "As underwear, you are allowed to wear only bras on Monday, Wednesday, Thursday, and Saturday, and only panties every other day. Don't let me down. 😘"
        ];

        // Chat Responses for Dom - Edit these as needed
        const DOM_RESPONSES = [
            "Good girl, I'm very proud of your dedication.",
            "You're doing wonderfully, babygirl. Keep it up.",
            "I love seeing your progress and commitment.",
            "Remember to focus on your tasks and growth.",
            "Your obedience brings me great pleasure.",
            "You're becoming exactly what I want you to be.",
            "I appreciate your honesty and openness.",
            "Continue to be the perfect submissive for me."
        ];

        // Intro Screen Text - Edit this as needed
        const INTRO_TEXT = {
            title: "Welcome to your personal dashboard, babygirl",
            description: "Here you can track your progress, complete tasks, and stay connected. Choose a tab from the left to begin your journey of growth and submission. Your devotion and obedience are what make our connection stronger every day."
        };

        // ==========================================
        // EASILY EDITABLE TEXT CONTENT - END
        // ==========================================

        // Application State Management
        const appState = {
            currentTab: 'pending',
            activeTasks: JSON.parse(localStorage.getItem('activeTasks')) || [],
            scoringData: JSON.parse(localStorage.getItem('scoringData')) || [],
            driveNavigation: [],
            chatMessages: JSON.parse(localStorage.getItem('chatMessages')) || [
                { type: 'dom', text: 'Welcome, babygirl. How are you feeling today?' }
            ]
        };

        // Utility Functions
        function saveToLocalStorage(key, data) {
            try {
                localStorage.setItem(key, JSON.stringify(data));
            } catch (e) {
                console.error('Error saving to localStorage:', e);
            }
        }

        function showFloatingOutput(text) {
            const output = document.getElementById('floatingOutput');
            output.textContent = text;
            output.classList.add('show');
            
            setTimeout(() => {
                output.classList.remove('show');
            }, 5000);
        }

        function addToActiveTasks(taskText) {
            // Remove oldest if we have 5 or more
            if (appState.activeTasks.length >= 5) {
                appState.activeTasks.shift();
            }
            
            const newTask = {
                id: Date.now(),
                text: taskText,
                timestamp: new Date().toISOString()
            };
            
            appState.activeTasks.push(newTask);
            saveToLocalStorage('activeTasks', appState.activeTasks);
        }

        function updateAverageScore() {
            if (appState.scoringData.length === 0) {
                document.getElementById('averageScore').textContent = '0';
                return;
            }
            
            const total = appState.scoringData.reduce((sum, item) => sum + item.score, 0);
            const average = Math.round(total / appState.scoringData.length);
            document.getElementById('averageScore').textContent = average;
        }

        // Tab Navigation Functions
        function switchTab(tabName) {
            // Update tab visual state
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

            // Reset drive navigation when switching tabs
            if (tabName !== 'drive') {
                appState.driveNavigation = [];
            }

            appState.currentTab = tabName;

            switch(tabName) {
                case 'pending':
                    showPendingTasks();
                    break;
                case 'mind':
                    showMindOptions();
                    break;
                case 'drive':
                    showDriveOptions();
                    break;
                case 'active':
                    showActiveTasks();
                    break;
                case 'scoring':
                    showScoring();
                    break;
                default:
                    showIntroScreen();
            }
        }

        function showIntroScreen() {
            document.getElementById('contentArea').innerHTML = `
                <div class="intro-screen">
                    <h2>${INTRO_TEXT.title}</h2>
                    <p>${INTRO_TEXT.description}</p>
                </div>
            `;
        }

        function showPendingTasks() {
            const content = `
                <h2 class="section-header">📋 Pending Tasklist</h2>
                ${PENDING_TASKS.map(task => `
                    <div class="task-card" onclick="handleTaskClick('${task.replace(/'/g, "\\'")}')">
                        <span style="position: relative; z-index: 1;">${task}</span>
                    </div>
                `).join('')}
            `;
            document.getElementById('contentArea').innerHTML = content;
        }

        function showMindOptions() {
            const content = `
                <h2 class="section-header">💭 What's on your mind</h2>
                ${MIND_OPTIONS.map(option => `
                    <div class="mind-option" onclick="handleMindClick('${option.replace(/'/g, "\\'")}')">
                        <span style="position: relative; z-index: 1;">${option}</span>
                    </div>
                `).join('')}
            `;
            document.getElementById('contentArea').innerHTML = content;
        }

        function showDriveOptions() {
            const breadcrumb = appState.driveNavigation.length > 0 ? 
                `<div class="drive-breadcrumb">
                    <span class="breadcrumb-item" onclick="resetDriveNavigation()">🏠 Start</span>
                    ${appState.driveNavigation.map((item, index) => `
                        <span class="breadcrumb-separator">→</span>
                        <span class="breadcrumb-item" onclick="navigateDriveTo(${index})">${item}</span>
                    `).join('')}
                </div>` : '';

            let content = `
                <h2 class="section-header">🎯 Drive</h2>
                ${breadcrumb}
            `;

            if (appState.driveNavigation.length === 0) {
                // Level 1
                content += DRIVE_OPTIONS.level1.map(option => `
                    <div class="drive-option" onclick="handleDriveClick('${option}', 1)">
                        <span style="position: relative; z-index: 1;">${option}</span>
                    </div>
                `).join('');
            } else if (appState.driveNavigation.length === 1) {
                // Level 2
                const level1Choice = appState.driveNavigation[0];
                content += DRIVE_OPTIONS.level2[level1Choice].map(option => `
                    <div class="drive-option" onclick="handleDriveClick('${option}', 2)">
                        <span style="position: relative; z-index: 1;">${option}</span>
                    </div>
                `).join('');
            } else if (appState.driveNavigation.length === 2) {
                // Level 3
                const level2Choice = appState.driveNavigation[1];
                content += DRIVE_OPTIONS.level3[level2Choice].map(option => `
                    <div class="drive-option" onclick="handleDriveClick('${option.replace(/'/g, "\\'")}', 3)">
                        <span style="position: relative; z-index: 1;">${option}</span>
                    </div>
                `).join('');
            }

            document.getElementById('contentArea').innerHTML = content;
        }

        function showActiveTasks() {
            const content = `
                <h2 class="section-header">✅ Active Tasklist</h2>
                ${appState.activeTasks.length === 0 ? 
                    '<p style="text-align: center; opacity: 0.7; font-style: italic; font-size: 1.2rem; margin-top: 40px;">No active tasks yet. Complete tasks from other tabs to see them here.</p>' :
                    appState.activeTasks.map(task => `
                        <div class="active-task">
                            <span>${task.text}</span>
                            <button class="done-button" onclick="markTaskDone(${task.id})" title="Dom Only">Done</button>
                        </div>
                    `).join('')
                }
            `;
            document.getElementById('contentArea').innerHTML = content;
        }

        function showScoring() {
            const content = `
                <h2 class="section-header">📊 Scoring</h2>
                ${appState.scoringData.length === 0 ? 
                    '<p style="text-align: center; opacity: 0.7; font-style: italic; font-size: 1.2rem; margin-top: 40px;">No completed tasks to score yet.</p>' :
                    `<table class="scoring-table">
                        <thead>
                            <tr>
                                <th>Task</th>
                                <th>Score (out of 100)</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${appState.scoringData.map(item => `
                                <tr>
                                    <td>${item.text}</td>
                                    <td>
                                        <input type="number" class="score-input" min="0" max="100" 
                                               value="${item.score}" 
                                               onchange="updateScore(${item.id}, this.value)">
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>`
                }
            `;
            document.getElementById('contentArea').innerHTML = content;
        }

        // Event Handlers
        function handleTaskClick(task) {
            showFloatingOutput(`Task added: ${task}`);
            addToActiveTasks(task);
        }

        function handleMindClick(option) {
            showFloatingOutput(`Mind state recorded: ${option}`);
            addToActiveTasks(option);
        }

        function handleDriveClick(option, level) {
            if (level === 3) {
                const fullPath = [...appState.driveNavigation, option].join(' → ');
                showFloatingOutput(`Drive task completed: ${fullPath}`);
                addToActiveTasks(`Drive: ${fullPath}`);
                resetDriveNavigation();
            } else {
                appState.driveNavigation.push(option);
                showDriveOptions();
            }
        }

        function resetDriveNavigation() {
            appState.driveNavigation = [];
            showDriveOptions();
        }

        function navigateDriveTo(index) {
            appState.driveNavigation = appState.driveNavigation.slice(0, index + 1);
            showDriveOptions();
        }

        function markTaskDone(taskId) {
            const taskIndex = appState.activeTasks.findIndex(task => task.id === taskId);
            if (taskIndex !== -1) {
                const task = appState.activeTasks[taskIndex];
                
                // Move to scoring
                appState.scoringData.push({
                    id: task.id,
                    text: task.text,
                    score: 0
                });
                
                // Remove from active tasks
                appState.activeTasks.splice(taskIndex, 1);
                
                // Save to localStorage
                saveToLocalStorage('activeTasks', appState.activeTasks);
                saveToLocalStorage('scoringData', appState.scoringData);
                
                showActiveTasks();
                updateAverageScore();
                showFloatingOutput('Task marked as done and moved to scoring!');
            }
        }

        function updateScore(taskId, newScore) {
            const task = appState.scoringData.find(item => item.id === taskId);
            if (task) {
                task.score = parseInt(newScore) || 0;
                saveToLocalStorage('scoringData', appState.scoringData);
                updateAverageScore();
            }
        }

        // Chat Functionality
        function toggleChatbox() {
            const chatbox = document.getElementById('chatbox');
            chatbox.classList.toggle('show');
            
            // Focus input when opened
            if (chatbox.classList.contains('show')) {
                setTimeout(() => {
                    document.getElementById('chatInput').focus();
                }, 100);
            }
        }

        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message) {
                addChatMessage('sub', message);
                input.value = '';
                
                // Simulate dom response
                setTimeout(() => {
                    const randomResponse = DOM_RESPONSES[Math.floor(Math.random() * DOM_RESPONSES.length)];
                    addChatMessage('dom', randomResponse);
                }, 1000 + Math.random() * 2000);
            }
        }

        function addChatMessage(type, text) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${type}`;
            messageDiv.textContent = text;
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            appState.chatMessages.push({ type, text });
            saveToLocalStorage('chatMessages', appState.chatMessages);
        }

        // Upload Functionality
        function toggleUploadWindow() {
            const uploadWindow = document.getElementById('uploadWindow');
            uploadWindow.classList.toggle('show');
        }

        function handleFileUpload() {
            const fileInput = document.getElementById('uploadFileInput');
            const files = fileInput.files;
            
            if (files.length > 0) {
                const fileNames = Array.from(files).map(file => file.name).join(', ');
                showFloatingOutput(`Files uploaded successfully: ${fileNames}`);
                toggleUploadWindow();
                fileInput.value = '';
            } else {
                showFloatingOutput('Please select files to upload.');
            }
        }

        // Weekly Tasks
        function handleWeeklyTasks() {
            const randomTask = WEEKLY_TASKS[Math.floor(Math.random() * WEEKLY_TASKS.length)];
            showFloatingOutput(`Weekly task: ${randomTask}`);
        }

        // Initialize chat messages from localStorage
        function loadChatMessages() {
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.innerHTML = '';
            
            appState.chatMessages.forEach(msg => {
                const messageDiv = document.createElement('div');
                messageDiv.className = `chat-message ${msg.type}`;
                messageDiv.textContent = msg.text;
                messagesContainer.appendChild(messageDiv);
            });
            
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Tab navigation
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });

            // Home button
            document.getElementById('homeButton').addEventListener('click', function() {
                showIntroScreen();
                // Reset active tab visual state
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.classList.remove('active');
                });
            });

            // Bottom ribbon buttons
            document.getElementById('chatboxBtn').addEventListener('click', toggleChatbox);
            document.getElementById('uploadBtn').addEventListener('click', toggleUploadWindow);
            document.getElementById('weeklyTasksBtn').addEventListener('click', handleWeeklyTasks);

            // Chat functionality
            document.getElementById('chatClose').addEventListener('click', toggleChatbox);
            document.getElementById('chatSend').addEventListener('click', sendChatMessage);
            document.getElementById('chatInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendChatMessage();
                }
            });

            // Upload functionality
            document.getElementById('uploadArea').addEventListener('click', function() {
                document.getElementById('uploadFileInput').click();
            });
            
            document.getElementById('uploadSubmit').addEventListener('click', handleFileUpload);

            // Drag and drop for uploads
            const uploadArea = document.getElementById('uploadArea');
            
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.style.borderColor = 'var(--color-primary)';
                this.style.background = 'rgba(230, 230, 250, 0.15)';
            });
            
            uploadArea.addEventListener('dragleave', function(e) {
                e.preventDefault();
                this.style.borderColor = 'rgba(230, 230, 250, 0.5)';
                this.style.background = 'transparent';
            });
            
            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                this.style.borderColor = 'rgba(230, 230, 250, 0.5)';
                this.style.background = 'transparent';
                
                const files = e.dataTransfer.files;
                document.getElementById('uploadFileInput').files = files;
            });

            // Initialize
            loadChatMessages();
            switchTab('pending');
            updateAverageScore();
        });
    </script>
</body>
</html>
